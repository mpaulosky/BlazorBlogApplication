@page "/"

<PageHeadingComponent Level="1" HeaderText="@_pageTitle" />

<h1>Welcome, @_username</h1>
You can only see this content if you're authenticated.
<br>
<img src="@_picture" alt="User Profile Picture" />

@code {

	private const string _pageTitle = "Home - Article Service";
	private string _username = "You're Article Service!";

	private string _picture = "";

	[CascadingParameter] private Task<AuthenticationState>? AuthenticationState { get; set; }

	protected override async Task OnInitializedAsync()
	{
		if (AuthenticationState is not null)
		{
			var state = await AuthenticationState;

			// Prefer email for greeting if available, fall back to identity name
			_username = state.User.Claims
			.Where(c => c.Type == System.Security.Claims.ClaimTypes.Email)
			.Select(c => c.Value)
			.FirstOrDefault() ?? state.User.Identity?.Name ?? string.Empty;

			_picture = state.User.Claims
			.Where(c => c.Type.Equals("picture"))
			.Select(c => c.Value)
			.FirstOrDefault() ?? string.Empty;
		}

		await base.OnInitializedAsync();
	}

}